{"is_source_file": true, "format": "JavaScript", "description": "This file is a controller module for authentication-related actions in a Node.js/Express backend, including user registration, login, and fetching current user profile.", "external_files": ["../models/User"], "external_methods": ["User.findOne", "User.create", "User.findById"], "published": ["exports.register", "exports.login", "exports.me"], "classes": [], "methods": [{"name": "register", "description": "Handles user registration, validating input, checking for existing users, hashing passwords, and creating new user records."}, {"name": "login", "description": "Auth process verifying user credentials and issuing JWT tokens."}, {"name": "me", "description": "Retrieves and returns the profile of the currently authenticated user."}], "calls": ["bcrypt.hash", "bcrypt.compare", "jwt.sign", "User.findOne", "User.create", "User.findById"], "search-terms": ["auth controller", "Node.js", "JWT", "user registration", "login"], "state": 2, "file_id": 19, "knowledge_revision": 46, "git_revision": "", "ctags": [{"_type": "tag", "name": "JWT_SECRET", "path": "/home/kavia/workspace/code-generation/student-collaboration-hub-141072-38888/student_admin_backend/src/controllers/auth.js", "pattern": "/^const JWT_SECRET = process.env.JWT_SECRET || 'secret123'; \\/\\/ Should be changed in production$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "User", "path": "/home/kavia/workspace/code-generation/student-collaboration-hub-141072-38888/student_admin_backend/src/controllers/auth.js", "pattern": "/^const User = require('..\\/models\\/User');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "bcrypt", "path": "/home/kavia/workspace/code-generation/student-collaboration-hub-141072-38888/student_admin_backend/src/controllers/auth.js", "pattern": "/^const bcrypt = require('bcryptjs');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "existing", "path": "/home/kavia/workspace/code-generation/student-collaboration-hub-141072-38888/student_admin_backend/src/controllers/auth.js", "pattern": "/^    const existing = await User.findOne({ email });$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "hash", "path": "/home/kavia/workspace/code-generation/student-collaboration-hub-141072-38888/student_admin_backend/src/controllers/auth.js", "pattern": "/^    const hash = await bcrypt.hash(password, 12);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "jwt", "path": "/home/kavia/workspace/code-generation/student-collaboration-hub-141072-38888/student_admin_backend/src/controllers/auth.js", "pattern": "/^const jwt = require('jsonwebtoken');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "newUser", "path": "/home/kavia/workspace/code-generation/student-collaboration-hub-141072-38888/student_admin_backend/src/controllers/auth.js", "pattern": "/^    const newUser = await User.create({ name, email, passwordHash: hash, role: safeRole });$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "safeRole", "path": "/home/kavia/workspace/code-generation/student-collaboration-hub-141072-38888/student_admin_backend/src/controllers/auth.js", "pattern": "/^    const safeRole = ['student', 'teacher', 'admin'].includes(role) ? role : 'student';$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "token", "path": "/home/kavia/workspace/code-generation/student-collaboration-hub-141072-38888/student_admin_backend/src/controllers/auth.js", "pattern": "/^    const token = jwt.sign({ uid: user._id, role: user.role }, JWT_SECRET, { expiresIn: '24h' })/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "user", "path": "/home/kavia/workspace/code-generation/student-collaboration-hub-141072-38888/student_admin_backend/src/controllers/auth.js", "pattern": "/^    const user = await User.findById(userId).select('-passwordHash');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "user", "path": "/home/kavia/workspace/code-generation/student-collaboration-hub-141072-38888/student_admin_backend/src/controllers/auth.js", "pattern": "/^    const user = await User.findOne({ email });$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "userId", "path": "/home/kavia/workspace/code-generation/student-collaboration-hub-141072-38888/student_admin_backend/src/controllers/auth.js", "pattern": "/^    const userId = req.user.uid;$/", "language": "JavaScript", "kind": "constant"}], "hash": "1b5c92c491fe33af68924b2a51f697b7", "format-version": 4, "code-base-name": "student_admin_backend", "filename": "student_admin_backend/src/controllers/auth.js", "revision_history": [{"46": ""}]}